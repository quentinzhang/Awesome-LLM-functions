# OpenFunctions

## 目标
这个项目旨在提供一个可供调用的实用函数集，可以实现一系列自己的功能函数，并与OpenAI的Function calling进行集成，通过这些功能函数对GPT的能力进行扩展，并通过ConsoleOne工作台方便的进行调试。

## 使用现有的函数

以下是具体步骤：

### 1. 初始化配置
从Github中将本项目克隆到本地，然后运行 ```npm install``` 安装必要的扩展。
然后将 .env.example 文件 复制为 .env 文件，在其中用来存放项目相关的API Key等。
```
cp .env.example .env
```
你还可以将 EXPECTED_API_KEY 的值换成任何自定义的字符串，用来设置函数的访问权限，你需要将 EXPECTED_API_KEY 的值填写到ConsoleOne工作台的函数调用设置中的

### 2. 设置函数描述
以实现获取天气信息的函数 getCurrentWeather.js 为例，首先将与getCurrentWeather函数相关的复制并粘贴到ConsoleOne工作台的函数调用设置中。

### 3. 发布函数
要想快速使用一个函数，最简单的方式是将函数发布到Vercel上，以下是具体的流程：

全局安装Vercel：
```npm i -g vercel```

首先在Vercel上创建用户，然后在项目根目录下初始化一个Vercel项目：
```vercel```
跟随向导一步步完成操作即可。

你可以先在本地搭建测试环境进行测试：
```vercel dev```
这将会在本地启动一个测试环境，并显示在终端上。我们以: http://localhost:3000 为例，这时你的函数调用路径就是：http://localhost:3000/api/

将该路径填写到ConsoleOne工作台的「函数调用路径」输入框中，然后打开「启用OpenAI函数调用」开关，并且在偏好设置中关闭「Steam模式」开关。（在stream模式下暂不能发起对外部函数的调用），你就可以通过对话测试函数调用是否生效。若生效，则在AI的回答下方会显示一个绿色信息框。像这样：

下方的绿色信息框中将会给出本次交互中调用的函数，点击信息框还可以在弹出窗口内看到中间过程的详细信息。

在本地调试通过后，你可以通过```vercel --prod```将函数发布到互联网上。发布成功之后，你需要将ConsoleOne工作台中的函数调用路径更换成Vercel生产环境的域名，并且将.evn中用到的环境变量设置到Vercel项目的环境变量设置中。即可不依赖本地环境更方便的使用函数。

3. 实现一个新函数
你想写一个新函数来实现一个特定功能也很简单！你只需用javascript语言写出一个新的nodejs函数即可。

之后将函数放在 /API 目录下，然后将关于函数结构的描述放在 /function_description 目录的 function_desc.json 文件中。

完成之后，像步骤2中一样进行测试和发布即可！

现在，你可以打开脑洞，动手实现自己的云函数！

如果你对本项目感兴趣，想要贡献自己的云函数，欢迎进入Discord服务器或微信群。